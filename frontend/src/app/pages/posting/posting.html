<!-- src/app/pages/posting/posting.html -->
<div class="posting-container">
  <h2>New Post</h2>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="posting-form">
    <!-- 共通: カテゴリー -->
    <div class="field">
      <label for="type">カテゴリー</label>
      <select id="type" formControlName="type">
        <option value="buy-sell">Buy & Sell</option>
        <option value="event">Event</option>
        <option value="article">Article / 口コミ</option>
      </select>
    </div>

    <!-- 共通: タイトル -->
    <div class="field">
      <label for="title">タイトル</label>
      <input id="title" formControlName="title" placeholder="例：IKEAのテーブル譲ります" />
    </div>

    <!-- 共通: 内容 -->
    <div class="field">
      <label for="body">内容</label>
      <textarea
        id="body"
        formControlName="body"
        rows="6"
        placeholder="詳細や条件などを書いてください"
      ></textarea>
    </div>

    <!-- 共通: 場所 -->
    <div class="field">
    <label for="location">
        場所
        <span *ngIf="selectedType === 'event'">（イベント会場）</span>
    </label>
    <input
        id="location"
        formControlName="location"
        [placeholder]="selectedType === 'event'
        ? '例：Glasgow Central / Zoom など'
        : '例：Glasgow West End / Online など'"
    />
    </div>

    <!-- ★ Buy & Sell 専用フィールド -->
    <ng-container *ngIf="selectedType === 'buy-sell'">
      <div class="field">
        <label>買いたい / 売りたい</label>
        <select formControlName="buySellIntent">
          <option [ngValue]="null">選択してください</option>
          <option value="buy">買いたい</option>
          <option value="sell">売りたい</option>
        </select>
      </div>

      <div class="field-inline">
        <div class="field">
          <label for="price">価格</label>
          <input
            id="price"
            type="number"
            formControlName="price"
            placeholder="例：20"
          />
        </div>

        <div class="field">
          <label for="priceCurrency">通貨</label>
          <select id="priceCurrency" formControlName="priceCurrency">
            <option value="GBP">GBP (£)</option>
            <option value="JPY">JPY (¥)</option>
          </select>
        </div>
      </div>

      <!-- ★ 連絡先 -->
      <div class="field">
        <label for="contactEmail">メール</label>
        <input
          id="contactEmail"
          type="email"
          formControlName="contactEmail"
          placeholder="例: example@gmail.com"
        />
      </div>

      <div class="field">
        <label for="contactInstagram">Instagram</label>
        <input
          id="contactInstagram"
          type="text"
          formControlName="contactInstagram"
          placeholder="例: myaccount（@は任意）"
        />
      </div>

      <div class="field">
        <label for="contactPhone">電話番号</label>
        <input
          id="contactPhone"
          type="tel"
          formControlName="contactPhone"
          placeholder="例: +44..."
        />
      </div>

      <div class="field">
        <label for="contactLine">LINE</label>
        <input
          id="contactLine"
          type="text"
          formControlName="contactLine"
          placeholder="例: line_id"
        />
      </div>
    </ng-container>

    <!-- ★ Event 専用フィールド -->
    <ng-container *ngIf="selectedType === 'event'">
      <div class="field">
        <label for="eventDate">日付</label>
        <input id="eventDate" type="date" formControlName="eventDate" />
      </div>

      <div class="field">
        <label for="maxParticipants">定員</label>
        <input
          id="maxParticipants"
          type="number"
          formControlName="maxParticipants"
          placeholder="例：20"
        />
      </div>
    </ng-container>

    <!-- ★ Article 専用フィールド -->
    <ng-container *ngIf="selectedType === 'article'">
      <div class="field">
        <label for="articleCategory">記事のカテゴリー</label>
        <input
          id="articleCategory"
          formControlName="articleCategory"
          placeholder="例：レストラン口コミ / 生活情報"
        />
      </div>
    </ng-container>

    <!-- 送信ボタン -->
    <div class="actions">
      <button type="submit" [disabled]="form.invalid || loading || !currentUserId">
        {{ loading ? 'Posting...' : 'Post' }}
      </button>
      <p *ngIf="!currentUserId" class="login-hint">
        ※投稿するにはログインが必要です
      </p>
    </div>
  </form>
</div>
